{
	"AWSTemplateFormatVersion": "2010-09-09",
	"Description": "Deployed via Cloud-Pricing-CloudWatch.json",
	"Parameters": {
		"PONumber": {
			"Description": "PO Number for billing",
			"Type": "String",
			"Default": "7000002358",
			"MinLength": "1",
			"MaxLength": "255",
			"AllowedPattern": "[\\x20-\\x7E]*",
			"ConstraintDescription": "Must contain only ASCII characters."
		},
		"PvtSNa": {
			"Description": "Private PRCP-NP Confidential Subnet 1 in us-east-11 CIDR: 10.133.103.0/24",
			"Type": "String",
			"Default": "subnet-0186b43162a344d9a"
		},
		"PvtSNb": {
			"Description": "Private PRCP-NP Confidential Subnet 2 in us-east-1b CIDR: 10.133.105.0/24",
			"Type": "String",
			"Default": "subnet-0ad1216eb31e15186"
		},
		"PvtSNc": {
			"Description": "Private PRCP-NP Confidential Subnet 3 in us-east-1c CIDR: 10.133.106.0/24",
			"Type": "String",
			"Default": "subnet-0a5d9eea71b9c97c6"
		},
		"VPCID": {
			"Description": "Name of and existing VPC",
			"Type": "String",
			"Default": "vpc-091c7e3e5578d7a4f"
		},
		"DNSSG": {
			"Description": "PRCP-NP-DNS-DNSSG-3J5600OVNNBR",
			"Type": "String",
			"Default": "sg-078061ddab53c5c41"
		},
		"SGRDSMySQL": {
			"Description": "SG-RDSMySQL",
			"Type": "String",
			"Default": "sg-039f822d40c446322"
		},
		"SGWebServices": {
			"Description": "SG-WebServices",
			"Type": "String",
			"Default": "sg-0a56447308e39b902"
		},
		"ApplicationID": {
			"Description": "Application ID - Official Application_ID, this is generated by Sysco's CMDB",
			"Type": "String",
			"Default": "APP-001151",
			"MinLength": "1",
			"MaxLength": "255",
			"AllowedPattern": "[\\x20-\\x7E]*",
			"ConstraintDescription": "Must contain only ASCII characters."
		},
		"ApplicationName": {
			"Description": "Application_Name - Common, user-friendly name",
			"Type": "String",
			"Default": "Cloud Pricing",
			"MinLength": "1",
			"MaxLength": "255",
			"AllowedPattern": "[\\x20-\\x7E]*",
			"ConstraintDescription": "Must contain only ASCII characters."
		},
		"Approver": {
			"Description": "Person approving instance funding.  This should be Email address formatted",
			"Type": "String",
			"Default": "Thibodeaux.Paula@corp.sysco.com",
			"MinLength": "1",
			"MaxLength": "255"
		},
		"Owner": {
			"Description": "Email address usually Product/ Platform Owner, though team distribution list for technical product/platform team contact",
			"Type": "String",
			"Default": "Owen.James@corp.sysco.com",
			"MinLength": "1",
			"MaxLength": "255"
		},
		"SupportEmail": {
			"Description": "Email distribution list for technical product/platform team contact",
			"Type": "String",
			"Default": "000-BT-PricingPlatform@Corp.sysco.com",
			"MinLength": "1",
			"MaxLength": "255"
		},
		"ProjectID": {
			"Description": "Project_ID - BT Project ID for this workload",
			"Type": "String",
			"Default": "BT.001176",
			"MinLength": "1",
			"MaxLength": "255",
			"AllowedPattern": "[\\x20-\\x7E]*",
			"ConstraintDescription": "Must contain only ASCII characters."
		},
		"2WTAGGER": {
			"Description": "Used by 2nd Watch Managed Services in shared accounts to determine if a resource is supported",
			"Type": "String",
			"Default": "team-managed",
			"MinLength": "1",
			"MaxLength": "255",
			"AllowedValues": [
				"team-managed",
				"adlm-managed",
				"2w-managed"
			],
			"ConstraintDescription": "Must contain only ASCII characters."
		},
		"CMPbackup": {
			"Description": "CMP_backup - This tag is used by 2W document appropriate backup policy for managed workloads",
			"Type": "String",
			"Default": "sysco_monthly_12",
			"MinLength": "1",
			"MaxLength": "255",
			"AllowedValues": [
				"sysco_daily_7",
				"sysco_daily_14",
				"sysco_daily_30",
				"sysco_weekly_4",
				"sysco_monthly_12"
			]
		},
		"Platform": {
			"Description": "Platform",
			"Type": "String",
			"Default": "Cloud Pricing V4"
		},
		"Environment": {
			"Description": "Name of logical build environment designated for service.",
			"Type": "String",
			"Default": "Non-Production",
			"AllowedValues": [
				"DEV",
				"QA",
				"STG",
				"TST",
				"Production",
				"Non-Production"
			],
			"ConstraintDescription": "Must be a valid environment."
		},
		"EnvironmentShort": {
			"Description": "Environment for application",
			"Type": "String",
			"Default": "EXE",
			"AllowedValues": [
				"DEV",
				"QA",
				"STG",
				"EXE",
				"TST",
				"PROD"
			],
			"ConstraintDescription": "Must be a valid environment."
		}
	},
	"Resources": {
		"EventRule": {
			"Type": "AWS::Events::Rule",
			"Properties": {
				"Name": "EC2-Event-Rule",
				"Description": "EC2 Event Rule",
				"EventPattern" :
				{
					"source": [ "aws.ec2" ],
					"detail-type": [ "EC2 Instance State-change Notification" ],
					"detail": {
						"state": [ "pending", "running", "shutting-down" ]
					}
				},
				"State": "ENABLED",
				"Targets": [
					{ "Arn": "arn:aws:lambda:us-east-1:037295147636:function:cp-aws-tagging", "Id": "cp-aws-tagging-id" }
				]
			}
		},
		"EventRuleRDS": {
			"Type": "AWS::Events::Rule",
			"Properties": {
				"Name": "RDS-Event-Rule",
				"Description": "RDS Event Rule",
				"EventPattern" :
				{
					"source": [ "aws.rds" ],
					"detail-type": [ "RDS Instance Event Notification" ],
					"detail": {
						"eventSource": ["rds.amazonaws.com"],
						"eventName": [ "CreateDBInstance", "DeleteDBInstance", "RebootDBInstance", "ModifyDBInstance" ]
					}
				},
				"State": "ENABLED",
				"Targets": [
					{ "Arn": "arn:aws:lambda:us-east-1:037295147636:function:cp-aws-tagging", "Id": "cp-aws-tagging-id" }
				]
			}
		},
		"PermissionForEventsToInvokeLambda": {
			"Type": "AWS::Lambda::Permission",
			"Properties": {
				"FunctionName": "cp-aws-tagging",
				"Action": "lambda:InvokeFunction",
				"Principal": "events.amazonaws.com",
				"SourceArn": { "Fn::GetAtt": ["EventRule", "Arn"] }
		  }
		}
	}
}