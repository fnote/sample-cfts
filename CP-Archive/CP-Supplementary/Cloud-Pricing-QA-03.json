{
	"AWSTemplateFormatVersion": "2010-09-09",
	"Description": "Deployed via Cloud-Pricing-QA-03.json - OD and Update Processors",
	"Parameters": {
		"PONumber": {
			"Description": "PO Number for billing",
			"Type": "String",
			"Default": "7000003106",
			"MinLength": "1",
			"MaxLength": "255",
			"AllowedPattern": "[\\x20-\\x7E]*",
			"ConstraintDescription": "Must contain only ASCII characters."
		},
		"PvtSNc": {
			"Description": "Private subnet for confidential apps in us-east-1c",
			"Type": "String",
			"Default": "subnet-b61cbb9d"
		},
		"PvtSNd": {
			"Description": "Private subnet for confidential apps in us-east-1d",
			"Type": "String",
			"Default": "subnet-ea138a9d"
		},
		"PvtSNe": {
			"Description" : "Private subnet for confidential apps in us-east-1e CIDR: 10.168.142.0/23",
			"Type": "String",
			"Default": "subnet-2512501f"
		},
		"VPCID": {
			"Description": "VPC - vpc_sysco_nonprod_02 CIDR: 10.168.128.0/20",
			"Type": "String",
			"Default": "vpc-ff88269a"
		},
		"NATaccessSG": {
			"Description": "vpc-sysco-nonprod-02-NatAccess-T1IHRRI726WJ",
			"Type": "String",
			"Default": "sg-e151a186",
			"ConstraintDescription": "Must be a valid NAT Security Group."
		},
		"CheckMKSG": {
			"Description": "CheckMK Security Group",
			"Type": "String",
			"Default": "sg-0f7fc468",
			"ConstraintDescription": "Must be a valid NAT Security Group."
		},
		"qaWEBSG": {
			"Description": "Cloud Pricing Quality Web Servers Security Group",
			"Type": "String",
			"Default": "sg-14d48271"
		},
		"CommonAMI": {
			"Description" : "CISGoldAWSL-02022018 - ami-6690911c",
			"Type": "String",
			"Default" : "ami-6690911c",
			"AllowedPattern" : "^ami-[0-9a-fA-F]{8}",
			"ConstraintDescription" : "Must be a valid AMI."
		},
		"qaWEBAMI": {
			"Description": "Cloud Pricing Quality Web Servers Security Group",
			"Type": "String",
			"Default": "ami-e428948c"
		},
		"ODAMI": {
			"Description": "AMI for OD servers",
			"Type": "String",
			"Default": "ami-a43d31cc"
		},
		"AMIUpdateProc": {
			"Description": "AMI for CP-UpdateProcessor-002 ami-ecc42481",
			"Type": "String",
			"Default": "ami-ecc42481"
		},
		"AMIMCP": {
			"Description" : "20160323-RHEL-7-2-BASE - ami-6da7ab07",
			"Type" : "String",
			"Default" : "ami-6da7ab07"
		},
		"PemKey": {
			"Description": "Name of and existing EC2 KeyPair to enable SSH access to the instance",
			"Type": "String",
			"Default": "Sysco-KP-CP-NonProd"
		},
		"PemKey2": {
			"Description": "Name of and existing EC2 KeyPair to enable SSH access to the instance",
			"Type": "String",
			"Default": "KeyPair-Sysco-CloudPricing-NonProd"
		},
		"InstanceProfileMCP": {
			"Description" : "Instance Profile Name for MCP",
			"Type" : "String",
			"Default" : "Application-CP-MCPServerRole"
		},
		"InstanceProfileUpdateServer": {
			"Description" : "Instance Profile Name for Update Server",
			"Type" : "String",
			"Default" : "Application-CP-UpdateServerRole"
		},
		"ApplicationName": {
			"Description": "Name of application",
			"Type": "String",
			"Default": "Cloud Pricing QA-UOM",
			"MinLength": "1",
			"MaxLength": "255",
			"AllowedPattern": "[\\x20-\\x7E]*",
			"ConstraintDescription": "Must contain only ASCII characters."
		},
		"ApplicationId": {
			"Description": "Application ID",
			"Type": "String",
			"Default": "APP-001151",
			"MinLength": "1",
			"MaxLength": "255",
			"AllowedPattern": "[\\x20-\\x7E]*",
			"ConstraintDescription": "Must contain only ASCII characters."
		},
		"QualityDBSG": {
			"Description": "Cloud Pricing Quality DB Servers Security Group",
			"Type": "String",
			"Default": "sg-ecd48289"
		},
		"PubSNc": {
			"Description": "Public subnet for the ELB in us-east-1c CIDR: 10.168.130.0/27",
			"Type": "String",
			"Default": "subnet-2cf35206"
		},
		"PubSNd": {
			"Description": "Public subnet for the ELB in us-east-1d CIDR: 10.168.130.32/27",
			"Type": "String",
			"Default": "subnet-24fed553"
		},
		"Approver": {
			"Description": "Name of application approver",
			"Type": "String",
			"Default": "Radulovich.Brigitte@corp.sysco.com",
			"MinLength": "1",
			"MaxLength": "255"
		},
		"Owner": {
			"Description": "Name of application owner",
			"Type": "String",
			"Default": "Owen.James@corp.sysco.com Rowland.Mike@corp.sysco.com",
			"MinLength": "1",
			"MaxLength": "255"
		},
		"ProjectId": {
			"Description": "Project ID",
			"Type": "String",
			"Default": "BT.001176",
			"MinLength": "1",
			"MaxLength": "255",
			"AllowedPattern": "[\\x20-\\x7E]*",
			"ConstraintDescription": "Must contain only ASCII characters."
		},
		"Platform": {
			"Description": "Platform",
			"Type": "String",
			"Default": "Cloud Pricing V1"
		},
		"Environment": {
			"Description": "Environment for application",
			"Type": "String",
			"Default": "Quality",
			"AllowedValues": [
				"Sandbox",
				"Development",
				"Quality",
				"Staging",
				"Training",
				"Production"
			],
			"ConstraintDescription": "Must be a valid environment."
		},
		"EnvironmentShort": {
			"Description": "Environment for application",
			"Type": "String",
			"Default": "QA",
			"AllowedValues": [
				"SBX",
				"DEV",
				"QA",
				"STG",
				"PROD"
			],
			"ConstraintDescription": "Must be a valid environment."
		}
	},
	"Resources": {
		"sgMCP" : {
			"Type" : "AWS::EC2::SecurityGroup",
			"Properties" : {
				"GroupDescription" : "CP MCP App SG",
				"VpcId" : { "Ref" : "VPCID" },
				"SecurityGroupIngress" : [ 
				{
					"IpProtocol" : "tcp",
					"FromPort" : "80",
					"ToPort" : "80",
					"CidrIp" : "10.0.0.0/8"
				},
				{
					"IpProtocol" : "tcp",
					"FromPort" : "80",
					"ToPort" : "8080",
					"CidrIp" : "10.0.0.0/8"
				},
				{
					"IpProtocol" : "tcp",
					"FromPort" : "22",
					"ToPort" : "22",
					"CidrIp" : "10.0.0.0/8"
				},
				{
					"IpProtocol" : "icmp",
					"FromPort" : "-1",
					"ToPort" : "-1",
					"CidrIp" : "10.0.0.0/8"
				}],
				"Tags" : [
					{ "Key" : "Name", "Value" : "sg/vpc_sysco_qa_01/cpmcp_qa_app" },
					{ "Key" : "Application_Name", "Value" : { "Ref" : "ApplicationName" } },
					{ "Key" : "Application_Id", "Value" : { "Ref" : "ApplicationId" } },
					{ "Key" : "Owner", "Value" : { "Ref" : "Owner" } },
					{ "Key" : "Approver", "Value" : { "Ref" : "Approver" } },
					{ "Key" : "PO_Number", "Value" : { "Ref" : "PONumber" } },
					{ "Key" : "Environment", "Value" : { "Ref" : "Environment" } },
					{ "Key" : "Project_ID", "Value" : { "Ref" : "ProjectId" } },
					{ "Key" : "Platform", "Value" : { "Ref" : "Platform" } }
				]
			}
		},
		"sgDBOD" : {
			"Type" : "AWS::EC2::SecurityGroup",
			"Properties" : {
				"GroupDescription" : "CP OD DB SG",
				"VpcId" : { "Ref" : "VPCID" },
				"SecurityGroupIngress" : [ 
				{
					"IpProtocol" : "tcp",
					"FromPort" : "3389",
					"ToPort" : "3389",
					"CidrIp" : "10.0.0.0/8"
				},
				{
					"IpProtocol" : "tcp",
					"FromPort" : "3181",
					"ToPort" : "3181",
					"CidrIp" : "10.0.0.0/8"
				},
				{
					"IpProtocol" : "tcp",
					"FromPort" : "1433",
					"ToPort" : "1433",
					"CidrIp" : "10.0.0.0/8"
				},
				{
					"IpProtocol" : "tcp",
					"FromPort" : "1501",
					"ToPort" : "1512",
					"CidrIp" : "10.0.0.0/8"
				},
				{
					"IpProtocol" : "tcp",
					"FromPort" : "80",
					"ToPort" : "80",
					"CidrIp" : "10.0.0.0/8"
				},
				{
					"IpProtocol" : "tcp",
					"FromPort" : "8080",
					"ToPort" : "8080",
					"CidrIp" : "10.0.0.0/8"
				},
				{
					"IpProtocol" : "icmp",
					"FromPort" : "-1",
					"ToPort" : "-1",
					"CidrIp" : "10.0.0.0/8"
				}
				],
				"Tags" : [
					{ "Key" : "Name", "Value" : "sg/vpc_sysco_dev_01/cpdbod_dev_app" },
					{ "Key" : "Application_Name", "Value" : { "Ref" : "ApplicationName" } },
					{ "Key" : "Application_Id", "Value" : { "Ref" : "ApplicationId" } },
					{ "Key" : "Owner", "Value" : { "Ref" : "Owner" } },
					{ "Key" : "Approver", "Value" : { "Ref" : "Approver" } },
					{ "Key" : "PO_Number", "Value" : { "Ref" : "PONumber" } },
					{ "Key" : "Environment", "Value" : { "Ref" : "Environment" } },
					{ "Key" : "Project_ID", "Value" : { "Ref" : "ProjectId" } },
					{ "Key" : "Platform", "Value" : { "Ref" : "Platform" } }
				]
			}
		}
	}
}